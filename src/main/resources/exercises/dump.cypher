MERGE (e:Exercise {instructions: 'Trouvez le nombre de films', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvdW70CfzIAQ=='})
MERGE (e:Exercise {instructions: 'Trouvez le nombre de films d\'action', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvdW70CbQm'})
MERGE (e:Exercise {instructions: 'Trouvez tous les titres de films joués par Vincent Cassel', result: 'ARcBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFMYXNjYXLzAQABAQMEAwFNZXNyaW5lOiBQdWJsaWMgRW5lbXkgTm8uILEBAAEBAwQDAVNoZWl0Ye4BAAEBAwQDAU1lc3JpbmU6IEtpbGxlciBJbnN0aW5j9AEAAQEDBAMBQWdlbnRzIHNlY3JldPMBAAEBAwQDAUwnYXBwYXJ0ZW1lbvQBAAEBAwQDAUd1ZXN0IEhvdXNlIFBhcmFkaXPvAQABAQMEAwFEb2Jlcm1hbu4BAAEBAwQDAVRoZSBNZXNzZW5nZXI6IFRoZSBTdG9yeSBvZiBKb2FuIG9mIEFy4wEAAQEDBAMBQmx1ZWJlcnL5AQABAQMEAwFEZXJhaWxl5AEAAQEDBAMBQnJvdGhlcmhvb2Qgb2YgdGhlIFdvbOYBAAEBAwQDAY9TdXIgbWVzIGzDqHZyZXMBAAEBAwQDAUhvdCBDaG9jb2xhdOUBAAEBAwQDAUVsaXphYmV06AEAAQEDBAMBVGhlIENyaW1zb24gUml2ZXLzAQABAQMEAwFFYXN0ZXJuIFByb21pc2XzAQABAQMEAwFCaXJ0aGRheSBHaXLsAQABAQMEAwFJcnJldmVyc2libOUBAAEBAwQDAVNocmXrAQABAQMEAwFUaGUgSGF05QEAAQEDBAMBT2NlYW4ncyBUaGlydGVl7gEAAQEDBAMBT2NlYW4ncyBUd2VsduU='})
MERGE (e:Exercise {instructions: 'Trouvez tous les titres de films que James Cameron a dirigé', result: 'AQYBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFUaGUgQWJ5c/MBAAEBAwQDAUFsaWVu8wEAAQEDBAMBVGl0YW5p4wEAAQEDBAMBVGVybWluYXRvciAyOiBKdWRnbWVudCBEYfkBAAEBAwQDAVRoZSBUZXJtaW5hdG/yAQABAQMEAwFBdmF0YfI='})
MERGE (e:Exercise {instructions: 'Trouvez tous les titres de films que James Cameron a dirigé pour le compte des studios Paramount Pictures', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFUaXRhbmnj'})
MERGE (e:Exercise {instructions: 'Trouvez les noms des acteurs qui ont joué dans le film que James Cameron a créé pour le compte des studios Paramount Pictures', result: 'AR0BAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAVNldGggQWRraW7zAQABAQMEAwFBbGV4YW5kcmVhIE93ZW7zAQABAQMEAwFHcmVnb3J5IENvb2vlAQABAQMEAwFNYXJ0aW4gRWFz9AEAAQEDBAMBU2NvdHQgRy4gQW5kZXJzb+4BAAEBAwQDAUVkd2FyZCBGbGV0Y2hl8gEAAQEDBAMBSm9uYXRoYW4gUGhpbGxpcPMBAAEBAwQDAUlvYW4gR3J1ZmZ1ZOQBAAEBAwQDAUV3YW4gU3Rld2Fy9AEAAQEDBAMBQmVybmFyZCBGb/gBAAEBAwQDAUVyaWMgQnJhZWRl7gEAAQEDBAMBTGV3IFBhbHRl8gEAAQEDBAMBTWljaGFlbCBFbnNpZ+4BAAEBAwQDAUphc29uIEJhcnL5AQABAQMEAwFEYW5ueSBOdWNj6QEAAQEDBAMBTmljaG9sYXMgQ2FzY29u5QEAAQEDBAMBTGV3aXMgQWJlcm5hdGj5AQABAQMEAwFTdXp5IEFtafMBAAEBAwQDAUpvbmF0aGFuIEh5ZOUBAAEBAwQDAVZpY3RvciBHYXJiZfIBAAEBAwQDAURhdmlkIFdhcm5l8gEAAQEDBAMBQmVybmFyZCBIaWzsAQABAQMEAwFCaWxsIFBheHRv7gEAAQEDBAMBR2xvcmlhIFN0dWFy9AEAAQEDBAMBS2F0aHkgQmF0ZfMBAAEBAwQDAUJpbGx5IFphbuUBAAEBAwQDAUZyYW5jZXMgRmlzaGXyAQABAQMEAwFMZW9uYXJkbyBEaUNhcHJp7wEAAQEDBAMBS2F0ZSBXaW5zbGX0'})
MERGE (e:Exercise {instructions: 'Trouvez le nom de l\'acteur qui a joué à la fois dans \'Titanic\' et \'The Lord of the Rings: The Return of the King\'', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAUJlcm5hcmQgSGls7A=='})
MERGE (e:Exercise {instructions: 'Trouvez toutes les personnes qui ont donné une note de 5 ainsi que les films qu\'ils ont noté ainsi', result: 'AQ8BAGphdmEudXRpbC5IYXNoTWHwAQIDAW5hbeUDAVRob21h8wMBdGl0bOUDAVRoZSBNYXRyafgBAAECAwQDAUVtaWwgRWlmcmXtAwYDAVRoZSBNYXRyaXggUmVsb2FkZeQBAAECAwQDAUVtaWwgRWlmcmXtAwYDAVRoZSBNYXRyafgBAAECAwQDAVJlbmF07wMGAwFUaGUgTWF0cml4IFJldm9sdXRpb27zAQABAgMEAwFTZXVuZ2Jlb+0DBgMBVGhlIE1hdHJp+AEAAQIDBAMBTWFoZXPoAwYDAUZvcnJlc3QgR3Vt8AEAAQIDBAMBVGltb3RoeSBCZXJrZWxl+QMGAwFBcG9jYWx5cHNlIE5v9wEAAQIDBAMBUGF0cmljayBEdXJ1c2H1AwYDAUdvbmUgd2l0aCB0aGUgV2lu5AEAAQIDBAMBU2FuZ3JlYewDBgMBVGhlIE1hdHJp+AEAAQIDBAMBU2FuZ3JlYewDBgMBRm9ycmVzdCBHdW3wAQABAgMEAwFTYW5ncmVh7AMGAwFUZXJtaW5hdG9yIFNhbHZhdGlv7gEAAQIDBAMBZGhhcm3rAwYDAVRoZSBNYXRyafgBAAECAwQDAXByZWX0AwYDAVRoZSBJdGFsaWFuIEpv4gEAAQIDBAMBVml0b/IDBgMBQmFjayB0byB0aGUgRnV0dXLlAQABAgMEAwFDYXRv7gMGAwFUaGUgU2ltcHNvbnMgTW92aeU='})
MERGE (e:Exercise {instructions: 'Trouvez tous les noms des directors ayant dirigé les films dont le titre contient \'titanic\'\nAstuce Cypher : il n\'existe pas de fonction CONTAINS ou LIKE en Cypher, on utilisera plutôt `string =~ \'my-regex\'`', result: 'AQUBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAUphbWVzIENhbWVyb+4BAAEBAwQDAUplYW4gTmVndWxlc2PvAQABAQMEAwFSb2JlcnQgTGllYmVybWHuAQABAQMEAwFKb2huIFBhdWwgRmVkZWzlAQABAQMEAwFXZXJuZXIgS2xpbmdsZfI='})
MERGE (e:Exercise {instructions: 'Trouvez tous les titres de film commençant par \'for\' (case-insensitive) avec leurs notes si elles existent, null sinon', result: 'ASEBAGphdmEudXRpbC5IYXNoTWHwAQIDAXN0YXLzCQoDAXRpdGzlAwFGb3JyZXN0IEd1bfABAAECAwQJCgMFAwFGb3JyZXN0IEd1bfABAAECAwQAAwUDAUZvciBZb3VyIEV5ZXMgT25s+QEAAQIDBAADBQMBRm9yYmlkZGVuIFBsYW5l9AEAAQIDBAADBQMBRm9yIGEgRmV3IERvbGxhcnMgTW9y5QEAAQIDBAADBQMBRm9ybXVsYSA1sQEAAQIDBAADBQMBRm9yY2VzIG9mIE5hdHVy5QEAAQIDBAADBQMBRm9ydCBTYWdhbm7lAQABAgMEAAMFAwFGb3JiaWRkZW4gR2FtZfMBAAECAwQAAwUDAUZvciBUaG9zZSB3aG8gaHVudCB0aGUgV291bmRlZCBkb3fuAQABAgMEAAMFAwFGb3IgTG92ZSBvciBNb25l+QEAAQIDBAADBQMBRm9yZ2V0dGluZyBTYXJhaCBNYXJzaGFs7AEAAQIDBAADBQMBRm9yYmlkZGVuIFdhcnJpb/IBAAECAwQAAwUDAUZvcmV2ZXIgWW91bucBAAECAwQAAwUDAUZvciBSaWNoZXIgb3IgUG9vcmXyAQABAgMEAAMFAwFGb3IgTG92ZSBvZiB0aGUgR2Ft5QEAAQIDBAADBQMBRm9yZ2V0IFBhcmnzAQABAgMEAAMFAwFGb3J0cmVzcyCyAQABAgMEAAMFAwFGb3J0cmVz8wEAAQIDBAADBQMBRm9yIFRoZSBCaXJk8wEAAQIDBAADBQMBRm9yIFlvdXIgQ29uc2lkZXJhdGlv7gEAAQIDBAADBQMBRm9ydHkgR3Vu8wEAAQIDBAADBQMBRm9yIFJpZ2h0IE9yIFdyb27nAQABAgMEAAMFAwFGb3IgdGhlIEJpYmxlIFRlbGxzIE1lIFPvAQABAgMEAAMFAwFGb3JiaWRkZW4gWm9u5QEAAQIDBAADBQMBRm9yYmlkZGXuAQABAgMEAAMFAwFGb3JjZSAxMCBmcm9tIE5hdmFyb27lAQABAgMEAAMFAwFGb3JldmVyIEx1bPUBAAECAwQAAwUDAUZvcmV2ZXIgdGhlIE1vbWVu9AEAAQIDBAADBQMBRm9yZXZlciBNaW7lAQABAgMEAAMFAwFGb3JnaXZpbmcgdGhlIEZyYW5rbGlu8wEAAQIDBAADBQMBRm9yZWlnbiBFeGNoYW5n5QEAAQIDBAADBQMBRm9yZ2l2aW5nIERyLiBNZW5nZWzl'})
MERGE (e:Exercise {instructions: 'Passons aux agrégations!\nTrouvez tous les titres de films, par ordre alphabétique croissant, qui ont reçu au moins 2 évaluations.\nAstuce Cypher : le combo COLLECT & WITH devrait vous aider !', result: 'AQIBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFGb3JyZXN0IEd1bfABAAEBAwQDAVRoZSBNYXRyafg='})
MERGE (e:Exercise {instructions: 'Trouvez les noms des deux derniers directors (il y en a 3), dans l\'ordre alphabétique croissant, qui ont dirigé au moins deux films avec des évaluations par des utilisateurs (User).', result: 'AQIBAGphdmEudXRpbC5IYXNoTWHwAQEDAWQubmFt5QMBUm9iZXJ0IFplbWVja2nzAQABAQMEAwFMYW5hIFdhY2hvd3Nr6Q=='})
MERGE (e:Exercise {instructions: 'Trouvez les noms des acteurs qui relient, via leur plus court chemin, l\'acteur 50 Cent (si si, c\'est aussi un acteur) et l\'acteur Michael Graham Cox.\nNote : le résultat inclut l\'acteur de départ et d\'arrivée.\nAstuce Cypher : les fonctions SHORTESTPATH, NODES et UNWIND devraient vous être utiles.', result: 'AQQBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAU1pY2hhZWwgR3JhaGFtIENv+AEAAQEDBAMBUmljaGFyZCBCcmllcvMBAAEBAwQDAVJvYmVydCBEZSBOaXLvAQABAQMEAwE1MCBDZW70'})
MERGE (e:Exercise {instructions: 'Passons aux exercices d\'écriture.\nFrance Télévisions est furieuse : Patrick Sébastien n\'est pas dans le graphe !\nPatrick Sébastien est à la fois acteur et producteur, le but du jeu est donc d\'insérer un noeud avec les deux labels correspondant et son nom.', validationQuery: 'MATCH (n:Actor:Director {name:\'Patrick Sébastien\'}) RETURN n.name AS name', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAZJQYXRyaWNrIFPDqWJhc3RpZW4='})
MERGE (e:Exercise {instructions: 'Toujours pas satisfaite, France TV revient à la charge !\nIl faut de nouveau ajouter Patrick Sébastien (seul son rôle de Director importe ici) mais également un des films dont il a le secret (insérer aussi le fait qu\'il l\'a dirigé):\nT\'aime, sorti en français en 1999 (définissez simplement son titre, sa langue et son timestamp de sortie: 922917600).', validationQuery: 'MATCH (director:Director {name:\'Patrick Sébastien\'})-[:DIRECTED]->(movie:Movie {title:"T\'aime", language:\'fr\', releaseDate:922917600}) RETURN director.name, movie.title, movie.language, movie.releaseDate', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQQDAW1vdmllLmxhbmd1YWflAwFm8gMBbW92aWUudGl0bOUDAVQnYWlt5QMBbW92aWUucmVsZWFzZURhdOUJwOuU8AYDAWRpcmVjdG9yLm5hbeUDAZJQYXRyaWNrIFPDqWJhc3RpZW4='})
MERGE (e:Exercise {instructions: 'Fait étrange : l\'utilisateur Emil Eifrem (accessoirement CEO de Neo4j Inc., mais c\'est une autre histoire), n\'a pas encore évalué le film \'The Matrix Revolutions\' contrairement aux deux opus précédents de la trilogie.\nCorrigeons cette erreur : Emil a aimé moyennement le film (3 stars) avec le commentaire: "Meh, liked the previous ones better".', validationQuery: 'MATCH (emil:User {name:\'Emil Eifrem\'}), (matrix:Movie {title:\'The Matrix Revolutions\'}) OPTIONAL MATCH (emil)-[r:RATED]->(matrix) RETURN r.stars AS stars, r.comment AS comment', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQIDAWNvbW1lbvQDAU1laCwgbGlrZWQgdGhlIHByZXZpb3VzIG9uZXMgYmV0dGXyAwFzdGFy8wkG'})
MERGE (e:Exercise {instructions: 'D\'ailleurs, réparons une injustice. Emil Eifrem devrait aussi être caractérisé par son rôle de CEO : sans lui, pas d\'atelier aujourd\'hui !\nAjoutons-lui un attribut \'profession\' dont la valeur sera \'CEO\'.', validationQuery: 'MATCH (emil:User {name:\'Emil Eifrem\'}) RETURN emil.profession AS profession', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAXByb2Zlc3Npb+4DAUNFzw=='})
MERGE (e:Exercise {instructions: 'L\'union des producteurs est révoltée : certaines évaluations sont en dessous de 5/5 !\nPour éviter que la purge soit trop évidente, l\'union a décidé de supprimer toutes les évaluations en dessous de 5, si et seulement si le login de l\'utilisateur contient un A (case-insensitive).\nAstuce Cypher : il n\'existe pas de fonction CONTAINS en Cypher, on utilisera plutôt `string =~ \'my-regex\'`', validationQuery: 'MATCH (u:User)-[r:RATED]->(:Movie) WHERE r.stars < 5 RETURN u.login AS login ORDER BY login ASC', result: 'AQUBAGphdmEudXRpbC5IYXNoTWHwAQEDAWxvZ2nuAwFkZXX6AQABAQMEAwFsMGuwAQABAQMEAwFtZO8BAAEBAwQDAXNvbmljbmXvAQABAQMEAwF0ZXP0'})
MERGE (e:Exercise {instructions: 'L\'experte SEO Agnès Iho vous demande d\'agir vite : supprimez les commentaires de moins de 15 caractères sinon le référencement va sombrer !\nAttention, les évaluations doivent rester !', validationQuery: 'MATCH (:User)-[r:RATED]->(:Movie) WHERE EXISTS(r.comment) RETURN LENGTH(r.comment) AS comment_length ORDER BY LENGTH(r.comment) ASC', result: 'AQkBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvbW1lbnRfbGVuZ3ToCSIBAAEBAwQJJgEAAQEDBAkmAQABAQMECSgBAAEBAwQJPgEAAQEDBAlAAQABAQMECUIBAAEBAwQJegEAAQEDBAm4AQ=='})
MERGE (e:Exercise {instructions: 'L\'architecte logiciel Rachid Tecte vient vous demander une optimisation.\nPlutôt que de le calculer à la volée, il souhaiterait persister le nombre de commentaires par film comme attribut de chaque film. Appelons cet attribut \'comment_count\' (parce que \'machin\', ça sonnait moins bien).\nAstuce Cypher : COLLECT est votre ami !', validationQuery: 'MATCH (m:Movie) WHERE m.comment_count > 0 RETURN m.title AS movie_title_with_at_least_one_comment', result: 'ARIBAGphdmEudXRpbC5IYXNoTWHwAQEDAW1vdmllX3RpdGxlX3dpdGhfYXRfbGVhc3Rfb25lX2NvbW1lbvQDAVRoZSBNYXRyafgBAAEBAwQDAVRoZSBNYXRyaXggUmVsb2FkZeQBAAEBAwQDAVRoZSBNYXRyaXggUmV2b2x1dGlvbvMBAAEBAwQDAUZvcnJlc3QgR3Vt8AEAAQEDBAMBQXBvY2FseXBzZSBOb/cBAAEBAwQDAVRoZSBTaW1wc29ucyBNb3Zp5QEAAQEDBAMBQmFjayB0byB0aGUgRnV0dXLlAQABAQMEAwFWZXJ0aWfvAQABAQMEAwFUZXJtaW5hdG9yIFNhbHZhdGlv7gEAAQEDBAMBV2FnIHRoZSBEb+cBAAEBAwQDAU1lZXQgdGhlIEZvY2tlcvMBAAEBAwQDAUdvbmUgd2l0aCB0aGUgV2lu5AEAAQEDBAMBSXJvbiBNYe4BAAEBAwQDAVRoZSBJdGFsaWFuIEpv4gEAAQEDBAMBQ3Jhc2ggVGVzdCBEdW1taWXzAQABAQMEAwFNb2/uAQABAQMEAwFDb21vIGFndWEgcGFyYSBjaG9jb2xhdOUBAAEBAwQDAUEgV2VkbmVzZGH5'})
MERGE (e:Exercise {instructions: 'Finalement, l\'union des producteurs a revu sa position.\nPlutôt que de retirer les mauvaises évaluations (note < 5), ils préfèreraient cette fois que vous signaliez les mauvaises évaluations via un nouvel attribut appelé \'hidden\' si leur auteur est influent (au moins 1 ami).', validationQuery: 'MATCH (u:User)-[r:RATED {hidden: true}]->(m:Movie) RETURN u.login AS login, r.stars AS hidden_review_stars, m.title AS title', result: 'AQQBAGphdmEudXRpbC5IYXNoTWHwAQMDAWhpZGRlbl9yZXZpZXdfc3RhcvMJCAMBbG9nae4DAW1haGVzaGtz8AMBdGl0bOUDAU1vb+4BAAEDAwQJCAMFAwFhZGlsZnVsYXLhAwcDAU1lZXQgdGhlIEZvY2tlcvMBAAEDAwQJCAMFAwFhZGlsZnVsYXLhAwcDAU1hZGFnYXNjYXI6IEVzY2FwZSAyIEFmcmlj4QEAAQMDBAkIAwUDAWFkaWxmdWxhcuEDBwMBVGhlIE1hdHJp+A=='})
MATCH (e:Exercise) WITH e ORDER BY ID(e) WITH COLLECT(e) AS exercises FOREACH (i IN RANGE(0, length(exercises)-2) | FOREACH (first IN [exercises[i]] | FOREACH (second IN [exercises[i+1]] | MERGE (first)-[:NEXT]->(second))))
