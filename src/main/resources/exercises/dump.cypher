MERGE (e:Exercise {rank: 1, instructions: 'Find the number of movies', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvdW70CfzIAQ=='})
MERGE (e:Exercise {rank: 2, instructions: 'Find the number of action movies', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvdW70CbQm'})
MERGE (e:Exercise {rank: 3, instructions: 'Find the titles of the movies in which Vincent Cassel plays', result: 'ARcBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFMYXNjYXLzAQABAQMEAwFNZXNyaW5lOiBQdWJsaWMgRW5lbXkgTm8uILEBAAEBAwQDAVNoZWl0Ye4BAAEBAwQDAU1lc3JpbmU6IEtpbGxlciBJbnN0aW5j9AEAAQEDBAMBQWdlbnRzIHNlY3JldPMBAAEBAwQDAUwnYXBwYXJ0ZW1lbvQBAAEBAwQDAUd1ZXN0IEhvdXNlIFBhcmFkaXPvAQABAQMEAwFEb2Jlcm1hbu4BAAEBAwQDAVRoZSBNZXNzZW5nZXI6IFRoZSBTdG9yeSBvZiBKb2FuIG9mIEFy4wEAAQEDBAMBQmx1ZWJlcnL5AQABAQMEAwFEZXJhaWxl5AEAAQEDBAMBQnJvdGhlcmhvb2Qgb2YgdGhlIFdvbOYBAAEBAwQDAY9TdXIgbWVzIGzDqHZyZXMBAAEBAwQDAUhvdCBDaG9jb2xhdOUBAAEBAwQDAUVsaXphYmV06AEAAQEDBAMBVGhlIENyaW1zb24gUml2ZXLzAQABAQMEAwFFYXN0ZXJuIFByb21pc2XzAQABAQMEAwFCaXJ0aGRheSBHaXLsAQABAQMEAwFJcnJldmVyc2libOUBAAEBAwQDAVNocmXrAQABAQMEAwFUaGUgSGF05QEAAQEDBAMBT2NlYW4ncyBUaGlydGVl7gEAAQEDBAMBT2NlYW4ncyBUd2VsduU='})
MERGE (e:Exercise {rank: 4, instructions: 'Find the titles of the movies directed by James Cameron', result: 'AQYBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFUaGUgQWJ5c/MBAAEBAwQDAUFsaWVu8wEAAQEDBAMBVGl0YW5p4wEAAQEDBAMBVGVybWluYXRvciAyOiBKdWRnbWVudCBEYfkBAAEBAwQDAVRoZSBUZXJtaW5hdG/yAQABAQMEAwFBdmF0YfI='})
MERGE (e:Exercise {rank: 5, instructions: 'Find the titles of the movies directed by James Cameron with Paramount Pictures studio', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFUaXRhbmnj'})
MERGE (e:Exercise {rank: 6, instructions: 'Find the names of the actors who played in the movies directed by James Cameron with Paramount Pictures studio', result: 'AR0BAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAUV3YW4gU3Rld2Fy9AEAAQEDBAMBQmVybmFyZCBGb/gBAAEBAwQDAUVyaWMgQnJhZWRl7gEAAQEDBAMBTGV3IFBhbHRl8gEAAQEDBAMBTWljaGFlbCBFbnNpZ+4BAAEBAwQDAUphc29uIEJhcnL5AQABAQMEAwFEYW5ueSBOdWNj6QEAAQEDBAMBTmljaG9sYXMgQ2FzY29u5QEAAQEDBAMBTGV3aXMgQWJlcm5hdGj5AQABAQMEAwFTdXp5IEFtafMBAAEBAwQDAUpvbmF0aGFuIEh5ZOUBAAEBAwQDAVZpY3RvciBHYXJiZfIBAAEBAwQDAURhdmlkIFdhcm5l8gEAAQEDBAMBQmVybmFyZCBIaWzsAQABAQMEAwFCaWxsIFBheHRv7gEAAQEDBAMBR2xvcmlhIFN0dWFy9AEAAQEDBAMBQWxleGFuZHJlYSBPd2Vu8wEAAQEDBAMBU2V0aCBBZGtpbvMBAAEBAwQDAU1hcnRpbiBFYXP0AQABAQMEAwFHcmVnb3J5IENvb2vlAQABAQMEAwFFZHdhcmQgRmxldGNoZfIBAAEBAwQDAVNjb3R0IEcuIEFuZGVyc2/uAQABAQMEAwFJb2FuIEdydWZmdWTkAQABAQMEAwFKb25hdGhhbiBQaGlsbGlw8wEAAQEDBAMBTGVvbmFyZG8gRGlDYXByae8BAAEBAwQDAUZyYW5jZXMgRmlzaGXyAQABAQMEAwFCaWxseSBaYW7lAQABAQMEAwFLYXRoeSBCYXRl8wEAAQEDBAMBS2F0ZSBXaW5zbGX0'})
MERGE (e:Exercise {rank: 7, instructions: 'Find the name of the actor who played both in \'Titanic\' and \'The Lord of the Rings: The Return of the King\'', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAUJlcm5hcmQgSGls7A=='})
MERGE (e:Exercise {rank: 8, instructions: 'Find the titles of the movies rated with 5 stars as well the names of the ones who rated it so', result: 'AQ8BAGphdmEudXRpbC5IYXNoTWHwAQIDAW5hbeUDAUVtaWwgRWlmcmXtAwF0aXRs5QMBVGhlIE1hdHJp+AEAAQIDBAMBRW1pbCBFaWZyZe0DBgMBVGhlIE1hdHJpeCBSZWxvYWRl5AEAAQIDBAMBUmVuYXTvAwYDAVRoZSBNYXRyaXggUmV2b2x1dGlvbvMBAAECAwQDAVNldW5nYmVv7QMGAwFUaGUgTWF0cmn4AQABAgMEAwFNYWhlc+gDBgMBRm9ycmVzdCBHdW3wAQABAgMEAwFUaW1vdGh5IEJlcmtlbGX5AwYDAUFwb2NhbHlwc2UgTm/3AQABAgMEAwFQYXRyaWNrIER1cnVzYfUDBgMBR29uZSB3aXRoIHRoZSBXaW7kAQABAgMEAwFTYW5ncmVh7AMGAwFGb3JyZXN0IEd1bfABAAECAwQDAVNhbmdyZWHsAwYDAVRoZSBNYXRyafgBAAECAwQDAVNhbmdyZWHsAwYDAVRlcm1pbmF0b3IgU2FsdmF0aW/uAQABAgMEAwFkaGFybesDBgMBVGhlIE1hdHJp+AEAAQIDBAMBcHJlZfQDBgMBVGhlIEl0YWxpYW4gSm/iAQABAgMEAwFWaXRv8gMGAwFCYWNrIHRvIHRoZSBGdXR1cuUBAAECAwQDAUNhdG/uAwYDAVRoZSBTaW1wc29ucyBNb3Zp5QEAAQIDBAMBVGhvbWHzAwYDAVRoZSBNYXRyafg='})
MERGE (e:Exercise {rank: 9, instructions: 'Find the names of the directors who directed movies which name contains \'titanic\'\nCypher protip: there is no LIKE keyword in Cypher, the =~ operator can be used instead, like `string =~ \'my-regex\'`', result: 'AQUBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAVJvYmVydCBMaWViZXJtYe4BAAEBAwQDAUpvaG4gUGF1bCBGZWRlbOUBAAEBAwQDAVdlcm5lciBLbGluZ2xl8gEAAQEDBAMBSmFtZXMgQ2FtZXJv7gEAAQEDBAMBSmVhbiBOZWd1bGVzY+8='})
MERGE (e:Exercise {rank: 10, instructions: 'Find the titles of the movies which name starts with \'for\' (in a case-insensitive way), optionally with their ratings (or null)', result: 'ASEBAGphdmEudXRpbC5IYXNoTWHwAQIDAXN0YXLzAAMBdGl0bOUDAUZvcnQgU2FnYW5u5QEAAQIDBAADBQMBRm9yYmlkZGVuIEdhbWXzAQABAgMEAAMFAwFGb3IgVGhvc2Ugd2hvIGh1bnQgdGhlIFdvdW5kZWQgZG937gEAAQIDBAADBQMBRm9yIExvdmUgb3IgTW9uZfkBAAECAwQAAwUDAUZvcmdldHRpbmcgU2FyYWggTWFyc2hhbOwBAAECAwQAAwUDAUZvcmJpZGRlbiBXYXJyaW/yAQABAgMEAAMFAwFGb3JldmVyIFlvdW7nAQABAgMEAAMFAwFGb3IgUmljaGVyIG9yIFBvb3Jl8gEAAQIDBAADBQMBRm9yIExvdmUgb2YgdGhlIEdhbeUBAAECAwQAAwUDAUZvcmdldCBQYXJp8wEAAQIDBAADBQMBRm9ydHJlc3MgsgEAAQIDBAADBQMBRm9ydHJlc/MBAAECAwQAAwUDAUZvciBUaGUgQmlyZPMBAAECAwQAAwUDAUZvciBZb3VyIENvbnNpZGVyYXRpb+4BAAECAwQAAwUDAUZvcnR5IEd1bvMBAAECAwQAAwUDAUZvciBSaWdodCBPciBXcm9u5wEAAQIDBAADBQMBRm9yIHRoZSBCaWJsZSBUZWxscyBNZSBT7wEAAQIDBAADBQMBRm9yYmlkZGVuIFpvbuUBAAECAwQAAwUDAUZvcmJpZGRl7gEAAQIDBAADBQMBRm9yY2UgMTAgZnJvbSBOYXZhcm9u5QEAAQIDBAADBQMBRm9yZXZlciBMdWz1AQABAgMEAAMFAwFGb3JldmVyIHRoZSBNb21lbvQBAAECAwQAAwUDAUZvcmV2ZXIgTWlu5QEAAQIDBAADBQMBRm9yZ2l2aW5nIHRoZSBGcmFua2xpbvMBAAECAwQAAwUDAUZvcmVpZ24gRXhjaGFuZ+UBAAECAwQAAwUDAUZvcmdpdmluZyBEci4gTWVuZ2Vs5QEAAQIDBAkKAwUDAUZvcnJlc3QgR3Vt8AEAAQIDBAkKAwUDAUZvcnJlc3QgR3Vt8AEAAQIDBAADBQMBRm9yIFlvdXIgRXllcyBPbmz5AQABAgMEAAMFAwFGb3JiaWRkZW4gUGxhbmX0AQABAgMEAAMFAwFGb3IgYSBGZXcgRG9sbGFycyBNb3LlAQABAgMEAAMFAwFGb3JtdWxhIDWxAQABAgMEAAMFAwFGb3JjZXMgb2YgTmF0dXLl'})
MERGE (e:Exercise {rank: 11, instructions: 'Aggregation time!\nFind the titles of the movies, in ascending alphabetical order, that received at least 2 ratings.\nCypher pro-tip: COLLECT & WITH are your friends', result: 'AQIBAGphdmEudXRpbC5IYXNoTWHwAQEDAXRpdGzlAwFGb3JyZXN0IEd1bfABAAEBAwQDAVRoZSBNYXRyafg='})
MERGE (e:Exercise {rank: 12, instructions: 'Find the names of the last two directors (friendly tip to make your life easier: only 3 directors match in total), in ascending alphabetical, who directed at least two movies with ratings.', result: 'AQIBAGphdmEudXRpbC5IYXNoTWHwAQEDAWQubmFt5QMBQW5keSBXYWNob3dza+kBAAEBAwQDAVJvYmVydCBaZW1lY2tp8w=='})
MERGE (e:Exercise {rank: 13, instructions: 'Find the names of the actors included in the shortest path between the actors 50 Cent and Michael Graham Cox.\nPlease note: the result should include both of these actors.\nCypher protip: the functions SHORTESTPATH, NODES and UNWIND should be useful ;)', result: 'AQQBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAU1pY2hhZWwgR3JhaGFtIENv+AEAAQEDBAMBUmljaGFyZCBCcmllcvMBAAEBAwQDAVJvYmVydCBEZSBOaXLvAQABAQMEAwE1MCBDZW70'})
MERGE (e:Exercise {rank: 14, instructions: 'Let\'s write to the database now!.\nFrance Télévisions is furious: Patrick Sébastien is not referenced in the data!\nPatrick Sébastien is both a great actor and director. Let\'s add him to the graph with his name and the adequate labels.', validationQuery: 'MATCH (n:Actor:Director {name:\'Patrick Sébastien\'}) RETURN n.name AS name', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAW5hbeUDAZJQYXRyaWNrIFPDqWJhc3RpZW4='})
MERGE (e:Exercise {rank: 15, instructions: 'France Télévisions is still pissed off, none of Patrick Sébastien\'s movies are referenced!\nLet\'s add him again (this time, only his director activity matters) and let\'s add his best movie as well (as well as the fact that he directed it):\nT\'aime, released in French in 1999 (only define the movie title, language and release timestamp: 922917600).', validationQuery: 'MATCH (director:Director {name:\'Patrick Sébastien\'})-[:DIRECTED]->(movie:Movie {title:"T\'aime", language:\'fr\', releaseDate:922917600}) RETURN director.name, movie.title, movie.language, movie.releaseDate', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQQDAW1vdmllLmxhbmd1YWflAwFm8gMBbW92aWUudGl0bOUDAVQnYWlt5QMBbW92aWUucmVsZWFzZURhdOUJwOuU8AYDAWRpcmVjdG9yLm5hbeUDAZJQYXRyaWNrIFPDqWJhc3RpZW4='})
MERGE (e:Exercise {rank: 16, instructions: 'Strangely enough, the biggest Matrix fan ever and Neo4j Inc. CEO Emil Eifrem has not yet rated the movie \'The Matrix Revolutions\'.\nLet\'s fix that, let\'s make Emil rate the movie with 3 stars and the following comment: "Meh, liked the previous ones better".', validationQuery: 'MATCH (emil:User {name:\'Emil Eifrem\'}), (matrix:Movie {title:\'The Matrix Revolutions\'}) OPTIONAL MATCH (emil)-[r:RATED]->(matrix) RETURN r.stars AS stars, r.comment AS comment', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQIDAWNvbW1lbvQDAU1laCwgbGlrZWQgdGhlIHByZXZpb3VzIG9uZXMgYmV0dGXyAwFzdGFy8wkG'})
MERGE (e:Exercise {rank: 17, instructions: 'By the way, let\'s add Emil Eifrem profession to the graph. After, without him, no Neo4j and no workshop today!\nAdd the \'profession\' attribute with the value \'CEO\' to the relevant node.', validationQuery: 'MATCH (emil:User {name:\'Emil Eifrem\'}) RETURN emil.profession AS profession', result: 'AQEBAGphdmEudXRpbC5IYXNoTWHwAQEDAXByb2Zlc3Npb+4DAUNFzw=='})
MERGE (e:Exercise {rank: 18, instructions: 'The director union is furious: some ratings are below 5 stars!\nLet\'s fix this discretely and remove all the ratings below 5 stars if and if the rater\'s login contains an a (case-insensitive).', validationQuery: 'MATCH (u:User)-[r:RATED]->(:Movie) WHERE r.stars < 5 RETURN u.login AS login ORDER BY login ASC', result: 'AQUBAGphdmEudXRpbC5IYXNoTWHwAQEDAWxvZ2nuAwFkZXX6AQABAQMEAwFsMGuwAQABAQMEAwFtZO8BAAEBAwQDAXNvbmljbmXvAQABAQMEAwF0ZXP0'})
MERGE (e:Exercise {rank: 19, instructions: 'The SEO expert Agnès Iho is asking you to remove all the comments which size is below 15 chars!\nSuch comments must be removed but the ratings must stay!', validationQuery: 'MATCH (:User)-[r:RATED]->(:Movie) WHERE EXISTS(r.comment) RETURN LENGTH(r.comment) AS comment_length ORDER BY LENGTH(r.comment) ASC', result: 'AQkBAGphdmEudXRpbC5IYXNoTWHwAQEDAWNvbW1lbnRfbGVuZ3ToCSIBAAEBAwQJJgEAAQEDBAkmAQABAQMECSgBAAEBAwQJPgEAAQEDBAlAAQABAQMECUIBAAEBAwQJegEAAQEDBAm4AQ=='})
MERGE (e:Exercise {rank: 20, instructions: 'The software architect Walter Falls vous demande d\'implémenter l\'optimisation suivante: instead of computing it every time, please persist the number of comments per movie as a movie attribute. Let\'s call this attribute \'comment_count\'.\nCypher pro-tip: COLLECT should help you!', validationQuery: 'MATCH (m:Movie) WHERE m.comment_count > 0 RETURN m.title AS movie_title_with_at_least_one_comment', result: 'ARIBAGphdmEudXRpbC5IYXNoTWHwAQEDAW1vdmllX3RpdGxlX3dpdGhfYXRfbGVhc3Rfb25lX2NvbW1lbvQDAVRoZSBJdGFsaWFuIEpv4gEAAQEDBAMBQ3Jhc2ggVGVzdCBEdW1taWXzAQABAQMEAwFNb2/uAQABAQMEAwFDb21vIGFndWEgcGFyYSBjaG9jb2xhdOUBAAEBAwQDAUEgV2VkbmVzZGH5AQABAQMEAwFUaGUgTWF0cmn4AQABAQMEAwFUaGUgTWF0cml4IFJlbG9hZGXkAQABAQMEAwFUaGUgTWF0cml4IFJldm9sdXRpb27zAQABAQMEAwFGb3JyZXN0IEd1bfABAAEBAwQDAUFwb2NhbHlwc2UgTm/3AQABAQMEAwFUaGUgU2ltcHNvbnMgTW92aeUBAAEBAwQDAUJhY2sgdG8gdGhlIEZ1dHVy5QEAAQEDBAMBVmVydGln7wEAAQEDBAMBVGVybWluYXRvciBTYWx2YXRpb+4BAAEBAwQDAVdhZyB0aGUgRG/nAQABAQMEAwFNZWV0IHRoZSBGb2NrZXLzAQABAQMEAwFHb25lIHdpdGggdGhlIFdpbuQBAAEBAwQDAUlyb24gTWHu'})
MERGE (e:Exercise {rank: 21, instructions: 'The director union has changed its strategy.\nInstead of removing the ratings below 5 stars like before, let\'s rather flag such bad ratings with a new attribute named \'hidden\' if their rater is an influencer (\'influencer\' means more than 1 friend in that case).', validationQuery: 'MATCH (u:User)-[r:RATED {hidden: true}]->(m:Movie) RETURN u.login AS login, r.stars AS hidden_review_stars, m.title AS title', result: 'AQQBAGphdmEudXRpbC5IYXNoTWHwAQMDAWhpZGRlbl9yZXZpZXdfc3RhcvMJCAMBbG9nae4DAW1haGVzaGtz8AMBdGl0bOUDAU1vb+4BAAEDAwQJCAMFAwFhZGlsZnVsYXLhAwcDAU1hZGFnYXNjYXI6IEVzY2FwZSAyIEFmcmlj4QEAAQMDBAkIAwUDAWFkaWxmdWxhcuEDBwMBVGhlIE1hdHJp+AEAAQMDBAkIAwUDAWFkaWxmdWxhcuEDBwMBTWVldCB0aGUgRm9ja2Vy8w=='})
MATCH (e:Exercise) WITH e ORDER BY e.rank ASC WITH collect(e) AS exercises FOREACH (i IN range(0, length(exercises)-2) | FOREACH (first IN [exercises[i]] | FOREACH (second IN [exercises[i+1]] | MERGE (first)-[:NEXT]->(second) REMOVE first.rank REMOVE second.rank)))
